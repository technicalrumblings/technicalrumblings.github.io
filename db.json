{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"themes/wind/source/css/google-prettify-monokai.css","path":"css/google-prettify-monokai.css","modified":0,"renderable":1},{"_id":"themes/wind/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/wind/source/img/avatar-default.png","path":"img/avatar-default.png","modified":0,"renderable":1},{"_id":"themes/wind/source/js/prettify.min.js","path":"js/prettify.min.js","modified":0,"renderable":1},{"_id":"themes/wind/source/js/script.js","path":"js/script.js","modified":0,"renderable":1}],"Cache":[{"_id":"source/_posts/civilization-memory-map.md","hash":"e9feb92cbc95c52ad69943a71941c4fd1fddc6f3","modified":1609797890102},{"_id":"source/_posts/hello-world.md","hash":"7d98d6592de80fdcd2949bd7401cec12afd98cdf","modified":1609783322015},{"_id":"source/_posts/civilization-memory-map/civilization-ghidra-memory-map.png","hash":"2d34b903fe4cac96987080ed4f6d7b9eb3149f04","modified":1609785353298},{"_id":"themes/wind/.gitignore","hash":"32764cd8ad9af0b900f5e10187726b24dcf956ff","modified":1609795424811},{"_id":"themes/wind/LICENSE","hash":"359cb81298c1fdbccf531548fc097466b0151be4","modified":1609795424811},{"_id":"themes/wind/README.md","hash":"b797612cbfc2021b1f06be692c138558a4fde8ab","modified":1609795424812},{"_id":"themes/wind/_config.yml","hash":"0308f3804365057802e51e1c47ca5895b16b98c1","modified":1609795424812},{"_id":"themes/wind/layout/archive.ejs","hash":"6ab1b609438d3f3dd38af02bdfde055e2f214c7e","modified":1609795424814},{"_id":"themes/wind/layout/index.ejs","hash":"8fe8365f38b3ed84ebed3c513a248caf7d1b7075","modified":1609795424814},{"_id":"themes/wind/layout/layout.ejs","hash":"56c9a3ee66e375bc17596d7fe19fcaafa8ba9b92","modified":1609795424814},{"_id":"themes/wind/layout/post.ejs","hash":"9fcb4256d5c096af10f33dd451032cd53433c049","modified":1609795424814},{"_id":"themes/wind/layout/_partial/about-info.ejs","hash":"a9f5d7b600c9a0d0a8930443951da3baa2900305","modified":1609795424812},{"_id":"themes/wind/layout/_partial/category.ejs","hash":"c8eb1e5e3ed0a23a69fea61dd0e5cf9915fa73f5","modified":1609795424812},{"_id":"themes/wind/layout/_partial/division.ejs","hash":"5d9ad9295127dc48509ee544bb5949b1dfe00909","modified":1609795424812},{"_id":"themes/wind/layout/_partial/footer.ejs","hash":"35aa2a09802bfed8500bb5e05e27acb3fd3f2295","modified":1609795424812},{"_id":"themes/wind/layout/_partial/head.ejs","hash":"578ac04f3315a6128b89c4865fa7d2dc063eea78","modified":1609795424813},{"_id":"themes/wind/layout/_partial/header.ejs","hash":"8f25caf5885c3bacc696fbf9ac287a48a20197ee","modified":1609795424813},{"_id":"themes/wind/layout/_partial/pagination.ejs","hash":"3eceb543de30e4c107add4eb482862cc4eae843e","modified":1609795424813},{"_id":"themes/wind/layout/_partial/to-top.ejs","hash":"518c9e57a43b88bb11708384ae614cc28146d2d4","modified":1609795424813},{"_id":"themes/wind/layout/_widget/bgmusic.ejs","hash":"c3b5002290664e16c7abba5f0554b9cf04066218","modified":1609795424813},{"_id":"themes/wind/layout/_widget/comment.ejs","hash":"9f72ac7b6de33bfd4b09315d59c6105d15ce97e5","modified":1609795424813},{"_id":"themes/wind/layout/_widget/gallery.ejs","hash":"6ec97079f23d47131e5d4926061eecc4e80a7978","modified":1609795424813},{"_id":"themes/wind/layout/_widget/google-analytics.ejs","hash":"8bff3b1bd066eef693319b82400c353b2d6736e7","modified":1609795424814},{"_id":"themes/wind/source/css/google-prettify-monokai.css","hash":"4c6cf4212360733412acb6b552dc6a3662c30fbb","modified":1609795424816},{"_id":"themes/wind/source/css/style.styl","hash":"3418a9c127673bdc7427e0f59f3213c28a3d6e49","modified":1609795424817},{"_id":"themes/wind/source/img/avatar-default.png","hash":"d9a3f4a2e50c77351c08deda0e80220a801a33d5","modified":1609795424817},{"_id":"themes/wind/source/js/prettify.min.js","hash":"dc88c36035221edf3d55e9c1b770a48b96d4872d","modified":1609795424817},{"_id":"themes/wind/source/js/script.js","hash":"9314f74abe1c73118d8e0073c7916b060dea8d58","modified":1609795424817},{"_id":"themes/wind/source/css/_partial/about-info.styl","hash":"3f9891eed8401618b89e62bb16457adbd0b4636b","modified":1609795424814},{"_id":"themes/wind/source/css/_partial/archive.styl","hash":"900668e3234a84ad5a6d3a8c8ba841bba9ab3ccb","modified":1609795424815},{"_id":"themes/wind/source/css/_partial/animation.styl","hash":"2e2ba2a8f4a4bf7c197bd4f23a33b2690818ca12","modified":1609795424815},{"_id":"themes/wind/source/css/_partial/category.styl","hash":"fa92717863f030b24c3f521247c62a31f81d1735","modified":1609795424815},{"_id":"themes/wind/source/css/_partial/common.styl","hash":"3a2634b583864f68660f15a848d96205b0950adc","modified":1609795424815},{"_id":"themes/wind/source/css/_partial/footer.styl","hash":"e90fe92a2959d5f0a2cf2d9e83e1cd21c1cf269a","modified":1609795424815},{"_id":"themes/wind/source/css/_partial/gallery.styl","hash":"65ee3fc6e35e1d5799e83d5233b7606feb5418c5","modified":1609795424816},{"_id":"themes/wind/source/css/_partial/header.styl","hash":"770c215c1ca882502e420788624590656b798867","modified":1609795424816},{"_id":"themes/wind/source/css/_partial/index.styl","hash":"fa89c3cf6ada730c5971c7b7b7f90562f7a0b6e9","modified":1609795424816},{"_id":"themes/wind/source/css/_partial/pagination.styl","hash":"f19e0c3a939bad33b0166daa0431c90b6e94b115","modified":1609795424816},{"_id":"themes/wind/source/css/_partial/post.styl","hash":"527f98a9a32932a88c22651afa83c1f867856c01","modified":1609795424816},{"_id":"themes/wind/source/css/_partial/to-top.styl","hash":"002f649340e11c7613757ac8533c5f3fd1f65b89","modified":1609795424816},{"_id":"themes/wind/source/css/_partial/variables.styl","hash":"2551ff35f2d7221fb6e8366837c2cc393beae4c1","modified":1609795424816},{"_id":"public/2021/01/04/civilization-memory-map/index.html","hash":"dedf49fa8a3e44534b837f0dc3599d120c316be2","modified":1610017231209},{"_id":"public/2021/01/04/hello-world/index.html","hash":"584300ca2b30100541554ead7f4122969ed8db9b","modified":1609795449183},{"_id":"public/archives/index.html","hash":"9da38de4f05427fe3fc9bfef0525f5e706664792","modified":1610017231209},{"_id":"public/archives/2021/index.html","hash":"9da38de4f05427fe3fc9bfef0525f5e706664792","modified":1610017231209},{"_id":"public/archives/2021/01/index.html","hash":"9da38de4f05427fe3fc9bfef0525f5e706664792","modified":1610017231209},{"_id":"public/index.html","hash":"e929d96c56834bfbb77b32ae3603e2a1f6cb5836","modified":1610017231209},{"_id":"public/img/avatar-default.png","hash":"d9a3f4a2e50c77351c08deda0e80220a801a33d5","modified":1610017231209},{"_id":"public/css/google-prettify-monokai.css","hash":"4c6cf4212360733412acb6b552dc6a3662c30fbb","modified":1610017231209},{"_id":"public/css/style.css","hash":"bb4924d628fd3dbfc9e1807ffafba0a99002a5de","modified":1609795449183},{"_id":"public/js/prettify.min.js","hash":"dc88c36035221edf3d55e9c1b770a48b96d4872d","modified":1610017231209},{"_id":"public/js/script.js","hash":"9314f74abe1c73118d8e0073c7916b060dea8d58","modified":1610017231209},{"_id":"public/2021/01/04/civilization-memory-map/civilization-ghidra-memory-map.png","hash":"2d34b903fe4cac96987080ed4f6d7b9eb3149f04","modified":1610017231209},{"_id":"source/_posts/dos-mcbs.png","hash":"bdf3a19195e01b1bd62f7ae5e59001e489dc0014","modified":1609795675277},{"_id":"source/_posts/civilization-memory-map/dos-mcbs.png","hash":"bdf3a19195e01b1bd62f7ae5e59001e489dc0014","modified":1609795675277},{"_id":"public/2021/01/04/civilization-memory-map/dos-mcbs.png","hash":"bdf3a19195e01b1bd62f7ae5e59001e489dc0014","modified":1610017231209},{"_id":"source/_posts/civilization-memory-map/ida-pro-segments.png","hash":"4d60d96a0b964222d0772ffe25f646debd564c40","modified":1609797043940},{"_id":"public/2021/01/04/civilization-memory-map/ida-pro-segments.png","hash":"4d60d96a0b964222d0772ffe25f646debd564c40","modified":1610017231209},{"_id":"source/_posts/Unbound-with-local-energized-blacklist-and-nextdns-forward-with-TLS.md","hash":"c02956226352512e70cdf7f36a1d1ba095e8bdbf","modified":1610017183674},{"_id":"source/_posts/Unbound-with-local-energized-blacklist-and-nextdns-forward-with-TLS/unbound.conf","hash":"61e2cab000d8e3e655bb0710cc776313147ba7a6","modified":1610006719787},{"_id":"public/2021/01/07/Unbound-with-local-energized-blacklist-and-nextdns-forward-with-TLS/index.html","hash":"016af862449a68e87bff587dce51d63968cfe6f0","modified":1610017231209},{"_id":"public/2021/01/07/Unbound-with-local-energized-blacklist-and-nextdns-forward-with-TLS/unbound.conf","hash":"61e2cab000d8e3e655bb0710cc776313147ba7a6","modified":1610017231209}],"Category":[],"Data":[],"Page":[],"Post":[{"title":"Civilization classic Ghidra Memory Map","date":"2021-01-04T18:34:23.000Z","_content":"This is the map for the memory dump of MSDOS version of Civilization Classic (474.04). Memory dump was captured from Dosbox-x (version dosbox-x-macosx-x64-20190301171645). \n*Note:* there can be differences in more recent version of DosBox-x with the .exe start address, i.e. where the seg000 is mapped. This has to be adjusted in IDA Pro and Ghidra\n![](civilization-ghidra-memory-map.png)\nMemory dump taken using Dosbox-x debugger\n`DOS MCBS                  - Show Memory Control Block chain.`\n`MEMDUMPBIN [s]:[o] [len]  - Write memory to file memdump.bin.`\n## Output of DOS MCBS\n![](dos-mcbs.png)\n*Note:* len is decimal\n## Sample command to grab memory dump that can be imported to Ghidra\n`MEMDUMBIN 01e8:0000 909681`\n## Reference to IDA Pro\nSegments have been mapped to reflect what can be seen in IDA Pro. IDA Pro splits code to segments automatically, it just needs right base. Maps in both programs, adjusted to start at base segment 0308, to allow seamless cross reference between Dosbox-x debugger, Ghidra and IDA Pro.\n![](ida-pro-segments.png)\n*Note: IDA Pro references CIV_UNP.EXE which is CIV.EXE unpacked.\n## More on the segments calculation\nHow did we come up with 0x0308 for the base segmentexactly if CIV starts at 02F7 as per DOS MCBS?\nThis has to do with the fact that 0x3080-0x2f70=0x110 bytes is some junk that I don't understand at the moment and actual assembly instructions start at 0x308.\n*Note:* Segment address has to be multiplied by 0x10 to get the absolute memory address\n","source":"_posts/civilization-memory-map.md","raw":"---\ntitle: Civilization classic Ghidra Memory Map\ndate: 2021-01-04 18:34:23\ntags:\n---\nThis is the map for the memory dump of MSDOS version of Civilization Classic (474.04). Memory dump was captured from Dosbox-x (version dosbox-x-macosx-x64-20190301171645). \n*Note:* there can be differences in more recent version of DosBox-x with the .exe start address, i.e. where the seg000 is mapped. This has to be adjusted in IDA Pro and Ghidra\n![](civilization-ghidra-memory-map.png)\nMemory dump taken using Dosbox-x debugger\n`DOS MCBS                  - Show Memory Control Block chain.`\n`MEMDUMPBIN [s]:[o] [len]  - Write memory to file memdump.bin.`\n## Output of DOS MCBS\n![](dos-mcbs.png)\n*Note:* len is decimal\n## Sample command to grab memory dump that can be imported to Ghidra\n`MEMDUMBIN 01e8:0000 909681`\n## Reference to IDA Pro\nSegments have been mapped to reflect what can be seen in IDA Pro. IDA Pro splits code to segments automatically, it just needs right base. Maps in both programs, adjusted to start at base segment 0308, to allow seamless cross reference between Dosbox-x debugger, Ghidra and IDA Pro.\n![](ida-pro-segments.png)\n*Note: IDA Pro references CIV_UNP.EXE which is CIV.EXE unpacked.\n## More on the segments calculation\nHow did we come up with 0x0308 for the base segmentexactly if CIV starts at 02F7 as per DOS MCBS?\nThis has to do with the fact that 0x3080-0x2f70=0x110 bytes is some junk that I don't understand at the moment and actual assembly instructions start at 0x308.\n*Note:* Segment address has to be multiplied by 0x10 to get the absolute memory address\n","slug":"civilization-memory-map","published":1,"updated":"2021-01-04T22:04:50.102Z","_id":"ckjj2napc0000s3o28m56cp21","comments":1,"layout":"post","photos":[],"link":"","content":"<p>This is the map for the memory dump of MSDOS version of Civilization Classic (474.04). Memory dump was captured from Dosbox-x (version dosbox-x-macosx-x64-20190301171645).<br><em>Note:</em> there can be differences in more recent version of DosBox-x with the .exe start address, i.e. where the seg000 is mapped. This has to be adjusted in IDA Pro and Ghidra<br><img src=\"civilization-ghidra-memory-map.png\"><br>Memory dump taken using Dosbox-x debugger<br><code>DOS MCBS                  - Show Memory Control Block chain.</code><br><code>MEMDUMPBIN [s]:[o] [len]  - Write memory to file memdump.bin.</code></p>\n<h2 id=\"Output-of-DOS-MCBS\"><a href=\"#Output-of-DOS-MCBS\" class=\"headerlink\" title=\"Output of DOS MCBS\"></a>Output of DOS MCBS</h2><p><img src=\"dos-mcbs.png\"><br><em>Note:</em> len is decimal</p>\n<h2 id=\"Sample-command-to-grab-memory-dump-that-can-be-imported-to-Ghidra\"><a href=\"#Sample-command-to-grab-memory-dump-that-can-be-imported-to-Ghidra\" class=\"headerlink\" title=\"Sample command to grab memory dump that can be imported to Ghidra\"></a>Sample command to grab memory dump that can be imported to Ghidra</h2><p><code>MEMDUMBIN 01e8:0000 909681</code></p>\n<h2 id=\"Reference-to-IDA-Pro\"><a href=\"#Reference-to-IDA-Pro\" class=\"headerlink\" title=\"Reference to IDA Pro\"></a>Reference to IDA Pro</h2><p>Segments have been mapped to reflect what can be seen in IDA Pro. IDA Pro splits code to segments automatically, it just needs right base. Maps in both programs, adjusted to start at base segment 0308, to allow seamless cross reference between Dosbox-x debugger, Ghidra and IDA Pro.<br><img src=\"ida-pro-segments.png\"><br>*Note: IDA Pro references CIV_UNP.EXE which is CIV.EXE unpacked.</p>\n<h2 id=\"More-on-the-segments-calculation\"><a href=\"#More-on-the-segments-calculation\" class=\"headerlink\" title=\"More on the segments calculation\"></a>More on the segments calculation</h2><p>How did we come up with 0x0308 for the base segmentexactly if CIV starts at 02F7 as per DOS MCBS?<br>This has to do with the fact that 0x3080-0x2f70=0x110 bytes is some junk that I don’t understand at the moment and actual assembly instructions start at 0x308.<br><em>Note:</em> Segment address has to be multiplied by 0x10 to get the absolute memory address</p>\n","site":{"data":{}},"excerpt":"","more":"<p>This is the map for the memory dump of MSDOS version of Civilization Classic (474.04). Memory dump was captured from Dosbox-x (version dosbox-x-macosx-x64-20190301171645).<br><em>Note:</em> there can be differences in more recent version of DosBox-x with the .exe start address, i.e. where the seg000 is mapped. This has to be adjusted in IDA Pro and Ghidra<br><img src=\"civilization-ghidra-memory-map.png\"><br>Memory dump taken using Dosbox-x debugger<br><code>DOS MCBS                  - Show Memory Control Block chain.</code><br><code>MEMDUMPBIN [s]:[o] [len]  - Write memory to file memdump.bin.</code></p>\n<h2 id=\"Output-of-DOS-MCBS\"><a href=\"#Output-of-DOS-MCBS\" class=\"headerlink\" title=\"Output of DOS MCBS\"></a>Output of DOS MCBS</h2><p><img src=\"dos-mcbs.png\"><br><em>Note:</em> len is decimal</p>\n<h2 id=\"Sample-command-to-grab-memory-dump-that-can-be-imported-to-Ghidra\"><a href=\"#Sample-command-to-grab-memory-dump-that-can-be-imported-to-Ghidra\" class=\"headerlink\" title=\"Sample command to grab memory dump that can be imported to Ghidra\"></a>Sample command to grab memory dump that can be imported to Ghidra</h2><p><code>MEMDUMBIN 01e8:0000 909681</code></p>\n<h2 id=\"Reference-to-IDA-Pro\"><a href=\"#Reference-to-IDA-Pro\" class=\"headerlink\" title=\"Reference to IDA Pro\"></a>Reference to IDA Pro</h2><p>Segments have been mapped to reflect what can be seen in IDA Pro. IDA Pro splits code to segments automatically, it just needs right base. Maps in both programs, adjusted to start at base segment 0308, to allow seamless cross reference between Dosbox-x debugger, Ghidra and IDA Pro.<br><img src=\"ida-pro-segments.png\"><br>*Note: IDA Pro references CIV_UNP.EXE which is CIV.EXE unpacked.</p>\n<h2 id=\"More-on-the-segments-calculation\"><a href=\"#More-on-the-segments-calculation\" class=\"headerlink\" title=\"More on the segments calculation\"></a>More on the segments calculation</h2><p>How did we come up with 0x0308 for the base segmentexactly if CIV starts at 02F7 as per DOS MCBS?<br>This has to do with the fact that 0x3080-0x2f70=0x110 bytes is some junk that I don’t understand at the moment and actual assembly instructions start at 0x308.<br><em>Note:</em> Segment address has to be multiplied by 0x10 to get the absolute memory address</p>\n"},{"title":"Unbound with local energized blacklist and TLS forward to NextDNS","date":"2021-01-07T07:40:57.000Z","_content":"## working configuration\n![](unbound.conf)\n## Install Unbound on FREEBSD\n`pkg install unbound`\n## Edit configuration - all below entries go under server: directive\n`vim /usr/local/etc/unbound/unbound.conf`\n### Configure chroot \n```\ndirectory: /usr/local/etc/unbound\nchroot: /usr/local/etc/unbound\n```\n### TLS cert bundle\n```tls-cert-bundle: /usr/local/share/certs/ca-root-nss.crt```\n### Caching TTLs\n```\ncache-min-ttl: 72000\ncache-max-ttl: 86400\n```\n### Local blacklist zone file\nDownload energized list from https://github.com/EnergizedProtection/block\n```wget https://block.energized.pro/ultimate/formats/unbound.conf```\n*Note:* - blacklist needs tweaking i.e. some entries need to be removed\n```include: /usr/local/etc/unbound/energized-ultimate.blacklist```\n\n### Forwarding address\n```forward-zone:\n                name:\".\"\n                forward-tls-upstream: yes\n                forward-addr: 45.90.28.0@853#<yourcode>.dns1.nextdns.io\n```\n\n## Enable remote control\n### In its own remote-control: section\n```remote-control:\n        control-enable: yes\n        control-use-cert: no\n```\n## Controling unbound\n### restart\n```service unbound restart```\n### flush zone\n```unbound-control flush_zone youtube.com```\n### dump cache\n```unbound-control dump_cache```\n\n{% codeblock [title] [lang:language] [url] [link text] [additional options] %}\ntest\n{% endcodeblock %}\n","source":"_posts/Unbound-with-local-energized-blacklist-and-nextdns-forward-with-TLS.md","raw":"---\ntitle: Unbound with local energized blacklist and TLS forward to NextDNS\ndate: 2021-01-07 07:40:57\ntags:\n---\n## working configuration\n![](unbound.conf)\n## Install Unbound on FREEBSD\n`pkg install unbound`\n## Edit configuration - all below entries go under server: directive\n`vim /usr/local/etc/unbound/unbound.conf`\n### Configure chroot \n```\ndirectory: /usr/local/etc/unbound\nchroot: /usr/local/etc/unbound\n```\n### TLS cert bundle\n```tls-cert-bundle: /usr/local/share/certs/ca-root-nss.crt```\n### Caching TTLs\n```\ncache-min-ttl: 72000\ncache-max-ttl: 86400\n```\n### Local blacklist zone file\nDownload energized list from https://github.com/EnergizedProtection/block\n```wget https://block.energized.pro/ultimate/formats/unbound.conf```\n*Note:* - blacklist needs tweaking i.e. some entries need to be removed\n```include: /usr/local/etc/unbound/energized-ultimate.blacklist```\n\n### Forwarding address\n```forward-zone:\n                name:\".\"\n                forward-tls-upstream: yes\n                forward-addr: 45.90.28.0@853#<yourcode>.dns1.nextdns.io\n```\n\n## Enable remote control\n### In its own remote-control: section\n```remote-control:\n        control-enable: yes\n        control-use-cert: no\n```\n## Controling unbound\n### restart\n```service unbound restart```\n### flush zone\n```unbound-control flush_zone youtube.com```\n### dump cache\n```unbound-control dump_cache```\n\n{% codeblock [title] [lang:language] [url] [link text] [additional options] %}\ntest\n{% endcodeblock %}\n","slug":"Unbound-with-local-energized-blacklist-and-nextdns-forward-with-TLS","published":1,"updated":"2021-01-07T11:13:48.625Z","_id":"ckjmkibbj0000o061hi7d9en8","comments":1,"layout":"post","photos":[],"link":"","content":"<h2 id=\"working-configuration\"><a href=\"#working-configuration\" class=\"headerlink\" title=\"working configuration\"></a>working configuration</h2><p><img src=\"unbound.conf\"></p>\n<h2 id=\"Install-Unbound-on-FREEBSD\"><a href=\"#Install-Unbound-on-FREEBSD\" class=\"headerlink\" title=\"Install Unbound on FREEBSD\"></a>Install Unbound on FREEBSD</h2><p><code>pkg install unbound</code></p>\n<h2 id=\"Edit-configuration-all-below-entries-go-under-server-directive\"><a href=\"#Edit-configuration-all-below-entries-go-under-server-directive\" class=\"headerlink\" title=\"Edit configuration - all below entries go under server: directive\"></a>Edit configuration - all below entries go under server: directive</h2><p><code>vim /usr/local/etc/unbound/unbound.conf</code></p>\n<h3 id=\"Configure-chroot\"><a href=\"#Configure-chroot\" class=\"headerlink\" title=\"Configure chroot\"></a>Configure chroot</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">directory: &#x2F;usr&#x2F;local&#x2F;etc&#x2F;unbound</span><br><span class=\"line\">chroot: &#x2F;usr&#x2F;local&#x2F;etc&#x2F;unbound</span><br></pre></td></tr></table></figure>\n<h3 id=\"TLS-cert-bundle\"><a href=\"#TLS-cert-bundle\" class=\"headerlink\" title=\"TLS cert bundle\"></a>TLS cert bundle</h3><p><code>tls-cert-bundle: /usr/local/share/certs/ca-root-nss.crt</code></p>\n<h3 id=\"Caching-TTLs\"><a href=\"#Caching-TTLs\" class=\"headerlink\" title=\"Caching TTLs\"></a>Caching TTLs</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cache-min-ttl: 72000</span><br><span class=\"line\">cache-max-ttl: 86400</span><br></pre></td></tr></table></figure>\n<h3 id=\"Local-blacklist-zone-file\"><a href=\"#Local-blacklist-zone-file\" class=\"headerlink\" title=\"Local blacklist zone file\"></a>Local blacklist zone file</h3><p>Download energized list from <a href=\"https://github.com/EnergizedProtection/block\">https://github.com/EnergizedProtection/block</a><br><code>wget https://block.energized.pro/ultimate/formats/unbound.conf</code><br><em>Note:</em> - blacklist needs tweaking i.e. some entries need to be removed<br><code>include: /usr/local/etc/unbound/energized-ultimate.blacklist</code></p>\n<h3 id=\"Forwarding-address\"><a href=\"#Forwarding-address\" class=\"headerlink\" title=\"Forwarding address\"></a>Forwarding address</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">name:&quot;.&quot;</span><br><span class=\"line\">forward-tls-upstream: yes</span><br><span class=\"line\">forward-addr: 45.90.28.0@853#&lt;yourcode&gt;.dns1.nextdns.io</span><br></pre></td></tr></table></figure>\n<h2 id=\"Enable-remote-control\"><a href=\"#Enable-remote-control\" class=\"headerlink\" title=\"Enable remote control\"></a>Enable remote control</h2><h3 id=\"In-its-own-remote-control-section\"><a href=\"#In-its-own-remote-control-section\" class=\"headerlink\" title=\"In its own remote-control: section\"></a>In its own remote-control: section</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">control-enable: yes</span><br><span class=\"line\">control-use-cert: no</span><br></pre></td></tr></table></figure>\n<h2 id=\"Controling-unbound\"><a href=\"#Controling-unbound\" class=\"headerlink\" title=\"Controling unbound\"></a>Controling unbound</h2><h3 id=\"restart\"><a href=\"#restart\" class=\"headerlink\" title=\"restart\"></a>restart</h3><p><code>service unbound restart</code></p>\n<h3 id=\"flush-zone\"><a href=\"#flush-zone\" class=\"headerlink\" title=\"flush zone\"></a>flush zone</h3><p><code>unbound-control flush_zone youtube.com</code></p>\n<h3 id=\"dump-cache\"><a href=\"#dump-cache\" class=\"headerlink\" title=\"dump cache\"></a>dump cache</h3><p><code>unbound-control dump_cache</code></p>\n<figure class=\"highlight plain\"><figcaption><span>[title] [lang:language] [url] [link text] [additional options]</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">test</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"working-configuration\"><a href=\"#working-configuration\" class=\"headerlink\" title=\"working configuration\"></a>working configuration</h2><p><img src=\"unbound.conf\"></p>\n<h2 id=\"Install-Unbound-on-FREEBSD\"><a href=\"#Install-Unbound-on-FREEBSD\" class=\"headerlink\" title=\"Install Unbound on FREEBSD\"></a>Install Unbound on FREEBSD</h2><p><code>pkg install unbound</code></p>\n<h2 id=\"Edit-configuration-all-below-entries-go-under-server-directive\"><a href=\"#Edit-configuration-all-below-entries-go-under-server-directive\" class=\"headerlink\" title=\"Edit configuration - all below entries go under server: directive\"></a>Edit configuration - all below entries go under server: directive</h2><p><code>vim /usr/local/etc/unbound/unbound.conf</code></p>\n<h3 id=\"Configure-chroot\"><a href=\"#Configure-chroot\" class=\"headerlink\" title=\"Configure chroot\"></a>Configure chroot</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">directory: &#x2F;usr&#x2F;local&#x2F;etc&#x2F;unbound</span><br><span class=\"line\">chroot: &#x2F;usr&#x2F;local&#x2F;etc&#x2F;unbound</span><br></pre></td></tr></table></figure>\n<h3 id=\"TLS-cert-bundle\"><a href=\"#TLS-cert-bundle\" class=\"headerlink\" title=\"TLS cert bundle\"></a>TLS cert bundle</h3><p><code>tls-cert-bundle: /usr/local/share/certs/ca-root-nss.crt</code></p>\n<h3 id=\"Caching-TTLs\"><a href=\"#Caching-TTLs\" class=\"headerlink\" title=\"Caching TTLs\"></a>Caching TTLs</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cache-min-ttl: 72000</span><br><span class=\"line\">cache-max-ttl: 86400</span><br></pre></td></tr></table></figure>\n<h3 id=\"Local-blacklist-zone-file\"><a href=\"#Local-blacklist-zone-file\" class=\"headerlink\" title=\"Local blacklist zone file\"></a>Local blacklist zone file</h3><p>Download energized list from <a href=\"https://github.com/EnergizedProtection/block\">https://github.com/EnergizedProtection/block</a><br><code>wget https://block.energized.pro/ultimate/formats/unbound.conf</code><br><em>Note:</em> - blacklist needs tweaking i.e. some entries need to be removed<br><code>include: /usr/local/etc/unbound/energized-ultimate.blacklist</code></p>\n<h3 id=\"Forwarding-address\"><a href=\"#Forwarding-address\" class=\"headerlink\" title=\"Forwarding address\"></a>Forwarding address</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">name:&quot;.&quot;</span><br><span class=\"line\">forward-tls-upstream: yes</span><br><span class=\"line\">forward-addr: 45.90.28.0@853#&lt;yourcode&gt;.dns1.nextdns.io</span><br></pre></td></tr></table></figure>\n<h2 id=\"Enable-remote-control\"><a href=\"#Enable-remote-control\" class=\"headerlink\" title=\"Enable remote control\"></a>Enable remote control</h2><h3 id=\"In-its-own-remote-control-section\"><a href=\"#In-its-own-remote-control-section\" class=\"headerlink\" title=\"In its own remote-control: section\"></a>In its own remote-control: section</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">control-enable: yes</span><br><span class=\"line\">control-use-cert: no</span><br></pre></td></tr></table></figure>\n<h2 id=\"Controling-unbound\"><a href=\"#Controling-unbound\" class=\"headerlink\" title=\"Controling unbound\"></a>Controling unbound</h2><h3 id=\"restart\"><a href=\"#restart\" class=\"headerlink\" title=\"restart\"></a>restart</h3><p><code>service unbound restart</code></p>\n<h3 id=\"flush-zone\"><a href=\"#flush-zone\" class=\"headerlink\" title=\"flush zone\"></a>flush zone</h3><p><code>unbound-control flush_zone youtube.com</code></p>\n<h3 id=\"dump-cache\"><a href=\"#dump-cache\" class=\"headerlink\" title=\"dump cache\"></a>dump cache</h3><p><code>unbound-control dump_cache</code></p>\n<figure class=\"highlight plain\"><figcaption><span>[title] [lang:language] [url] [link text] [additional options]</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">test</span><br></pre></td></tr></table></figure>\n"}],"PostAsset":[{"_id":"source/_posts/civilization-memory-map/civilization-ghidra-memory-map.png","slug":"civilization-ghidra-memory-map.png","post":"ckjj2napc0000s3o28m56cp21","modified":0,"renderable":0},{"_id":"source/_posts/civilization-memory-map/dos-mcbs.png","slug":"dos-mcbs.png","post":"ckjj2napc0000s3o28m56cp21","modified":0,"renderable":0},{"_id":"source/_posts/civilization-memory-map/ida-pro-segments.png","slug":"ida-pro-segments.png","post":"ckjj2napc0000s3o28m56cp21","modified":0,"renderable":0},{"_id":"source/_posts/Unbound-with-local-energized-blacklist-and-nextdns-forward-with-TLS/unbound.conf","slug":"unbound.conf","post":"ckjmkibbj0000o061hi7d9en8","modified":0,"renderable":0}],"PostCategory":[],"PostTag":[],"Tag":[]}}